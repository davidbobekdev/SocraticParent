<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="The Anti-Homework-Solver: Transform homework into meaningful learning moments">
    <title>Socratic Parent - Pedagogical Firewall</title>
    <link rel="stylesheet" href="/static/styles.css?v=17">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <!-- Paddle.js Billing v2 -->
    <script src="https://cdn.paddle.com/paddle/v2/paddle.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                </svg>
                <h1 class="logo-text">Socratic Parent</h1>
            </div>
            <div class="header-right">
                <span id="userInfo" class="user-info"></span>
                <span id="usageInfo" class="usage-info">Loading...</span>
                <button id="upgradeBtn" class="btn-upgrade" style="display:none;">‚≠ê Upgrade to Premium</button>
                <button onclick="logout()" class="logout-btn">Logout</button>
            </div>
            <p class="tagline">The Anti-Homework-Solver for the 2026 AI-Saturated Era</p>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Upload Section -->
            <section id="uploadSection" class="upload-section">
                <div class="upload-card">
                    <div class="upload-header">
                        <h2>Upload Your Child's Homework</h2>
                        <p class="subtitle">Snap a photo or drag & drop an image</p>
                    </div>

                    <!-- Grade Level Selection -->
                    <div class="grade-selector">
                        <label for="gradeSelect">Grade Level (Optional):</label>
                        <select id="gradeSelect" class="grade-select">
                            <option value="">Select grade...</option>
                            <option value="K-2">Kindergarten - 2nd Grade</option>
                            <option value="3-5">3rd - 5th Grade</option>
                            <option value="6-8">6th - 8th Grade (Middle School)</option>
                            <option value="9-12">9th - 12th Grade (High School)</option>
                        </select>
                    </div>

                    <!-- Upload Area -->
                    <div id="dropZone" class="drop-zone">
                        <input type="file" id="fileInput" accept="image/*" style="position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer;z-index:5;">
                        <div class="drop-zone-content">
                            <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                            </svg>
                            <p class="drop-text">Drag & drop an image here</p>
                            <p class="drop-text-or">or</p>
                            <button id="browseBtn" class="btn btn-primary" type="button">Browse Files</button>
                        </div>
                        <div id="imagePreview" class="image-preview hidden">
                            <img id="previewImg" alt="Homework preview">
                            <button id="removeBtn" class="btn-remove">‚úï</button>
                        </div>
                    </div>

                    <!-- Camera Capture -->
                    <div class="camera-section">
                        <button id="cameraBtn" class="btn btn-secondary">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                                <circle cx="12" cy="13" r="4"/>
                            </svg>
                            Take Photo
                        </button>
                    </div>

                    <!-- Analyze Button -->
                    <button id="analyzeBtn" class="btn btn-analyze hidden">
                        Analyze Homework
                    </button>
                </div>

                <!-- Empty State Message -->
                <div class="empty-state">
                    <p class="empty-text">‚ú® Waiting for your child's genius...</p>
                </div>
            </section>

            <!-- Loading State -->
            <section id="loadingSection" class="loading-section hidden">
                <div class="loading-card">
                    <div class="loader"></div>
                    <p class="loading-text">Analyzing homework...</p>
                    <p class="loading-subtext">Preparing your coaching script</p>
                </div>
            </section>

            <!-- Results Section -->
            <section id="resultsSection" class="results-section hidden">
                <div class="results-card">
                    <div class="results-header">
                        <h2>Your Coaching Script</h2>
                        <p class="results-subtitle">Read this before speaking with your child</p>
                    </div>

                    <!-- Subject Badge -->
                    <div class="subject-badge">
                        <span id="subjectText">Mathematics</span>
                    </div>

                    <!-- Questions -->
                    <div class="questions-container">
                        <div class="question-card spark">
                            <div class="question-header">
                                <span class="question-icon">üåü</span>
                                <h3>THE SPARK</h3>
                                <p class="question-subtitle">Activate what they know</p>
                            </div>
                            <p id="foundationQuestion" class="question-text"></p>
                        </div>

                        <div class="question-card climb">
                            <div class="question-header">
                                <span class="question-icon">üßó</span>
                                <h3>THE CLIMB</h3>
                                <p class="question-subtitle">Point to the roadblock</p>
                            </div>
                            <p id="bridgeQuestion" class="question-text"></p>
                        </div>

                        <div class="question-card summit">
                            <div class="question-header">
                                <span class="question-icon">‚õ∞Ô∏è</span>
                                <h3>THE SUMMIT</h3>
                                <p class="question-subtitle">Verify independence</p>
                            </div>
                            <p id="masteryQuestion" class="question-text"></p>
                        </div>
                    </div>

                    <!-- Behavioral Tip -->
                    <div class="tip-card">
                        <div class="tip-header">
                            <span class="tip-icon">üí°</span>
                            <h3>Teacher Tip</h3>
                        </div>
                        <p id="behavioralTip" class="tip-text"></p>
                    </div>
                    <!-- Paywall Overlay -->
                    <div id="paywallOverlay" class="paywall-overlay hidden">
                        <div class="paywall-content">
                            <h2>üîí Unlock Full Solution</h2>
                            <p>You've used all 3 free scans today!</p>
                            <p class="paywall-subtitle">Get unlimited access with Premium</p>
                            <ul class="paywall-features">
                                <li>‚ú® Unlimited homework scans</li>
                                <li>üìö Full step-by-step solutions</li>
                                <li>üí° Teacher tips & guidance</li>
                                <li>üéØ Priority support</li>
                            </ul>
                            <button id="paywallUpgradeBtn" class="btn-upgrade-large">
                                ‚≠ê Upgrade to Premium - $9.99/month
                            </button>
                            <p class="paywall-note">Cancel anytime. No long-term commitment.</p>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="action-buttons">
                        <button id="showExampleBtn" class="btn btn-outline">
                            üí° Need Help? Show Example Approach
                        </button>
                        <button id="showStepsBtn" class="btn btn-outline">
                            üìù Show Solution Steps
                        </button>
                        <button id="newAnalysisBtn" class="btn btn-solid">
                            Analyze Another
                        </button>
                    </div>
                    
                    <!-- Example Approach (Hidden by default) -->
                    <div id="exampleSection" class="example-section hidden">
                        <div class="example-card">
                            <div class="example-header">
                                <span class="example-icon">üìö</span>
                                <h3>Example Approach for Parents</h3>
                            </div>
                            <div class="example-note">
                                <strong>‚ö†Ô∏è Parent Mode:</strong> This section helps YOU understand the concept better. 
                                DO NOT read this directly to your child. Use the Socratic questions above instead.
                            </div>
                            <div id="exampleContent" class="example-content">
                                <p><strong>Concept Overview:</strong> The problem requires understanding the relationship between the known and unknown elements.</p>
                                <p><strong>Common Mistakes:</strong> Students often skip foundational steps or rush to the answer.</p>
                                <p><strong>Guiding Principle:</strong> Break the problem into smaller parts and verify each step.</p>
                                <p><strong>What NOT to say:</strong> Never give the final answer. Let them discover it through questioning.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Solution Steps (Progressive Reveal) -->
                    <div id="stepsSection" class="steps-section hidden">
                        <div class="steps-card">
                            <div class="steps-header">
                                <span class="steps-icon">üìù</span>
                                <h3>Solution Steps (Progressive Reveal)</h3>
                            </div>
                            <div class="steps-note">
                                <strong>‚ö†Ô∏è Last Resort:</strong> Use this only after trying the Socratic questions. 
                                Click "Next Step" to reveal one step at a time.
                            </div>
                            <div id="stepsContainer" class="steps-container"></div>
                            <div class="steps-controls">
                                <button id="nextStepBtn" class="btn btn-primary">
                                    üëâ Reveal Next Step
                                </button>
                                <button id="resetStepsBtn" class="btn btn-secondary hidden">
                                    üîÑ Reset Steps
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Error State -->
            <section id="errorSection" class="error-section hidden">
                <div class="error-card">
                    <div class="error-icon">‚ö†Ô∏è</div>
                    <h3 class="error-title">Oops! Something went wrong</h3>
                    <p id="errorMessage" class="error-message"></p>
                    <button id="retryBtn" class="btn btn-secondary">Try Again</button>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p class="footer-text">
                <strong>Privacy First:</strong> Images are processed securely and never stored.
            </p>
            <p class="footer-subtext">
                Turning homework from conflict into connection. ¬© 2026 Socratic Parent
            </p>
        </footer>
    </div>

    <!-- Camera Modal -->
    <div id="cameraModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Take a Photo</h3>
                <button id="closeCameraBtn" class="btn-close">‚úï</button>
            </div>
            <video id="cameraStream" class="camera-stream" autoplay playsinline></video>
            <canvas id="cameraCanvas" hidden></canvas>
            <div class="modal-actions">
                <button id="captureBtn" class="btn btn-primary">Capture</button>
                <button id="cancelCameraBtn" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js?v=17"></script>
</body>
</html>
